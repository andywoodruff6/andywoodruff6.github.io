{{- define "main" }}

<header class="page-header">
    <h1>{{ .Title }}</h1>
    {{- if .Description }}
    <div class="post-description">
        {{ .Description }}
    </div>
    {{- end }}
</header>

{{/* Search Box */}}
<div class="archive-search-box">
    <input
        type="search"
        id="archive-search"
        placeholder="Search posts..."
        autocomplete="off"
        aria-label="Search posts"
    >
</div>

{{/* Tag Filters */}}
<div class="archive-tag-filters">
    <span class="archive-tag-label">Filter by tag:</span>
    <div id="archive-tags" class="archive-tags">
        {{- range site.Taxonomies.tags.Alphabetical }}
        <button
            type="button"
            class="archive-tag-btn"
            data-tag="{{ .Name }}"
            aria-pressed="false"
        >
            {{ .Name }}
            <span class="archive-tag-count">{{ .Count }}</span>
        </button>
        {{- end }}
    </div>
</div>

{{/* Results Meta Bar */}}
<div class="archive-meta-bar">
    <span id="archive-count">Loading...</span>
    <button type="button" id="archive-clear" class="archive-clear-btn" style="display:none;">
        Clear filters
    </button>
</div>

{{/* Results Container - Populated by JavaScript */}}
<div id="archive-results" class="archive-results">
    {{/* Server-rendered fallback for no-JS */}}
    <noscript>
        {{- $pages := site.RegularPages }}
        {{- range $pages.ByDate.Reverse }}
        {{- if eq .Kind "page" }}
        <div class="archive-entry">
            <div class="archive-entry-header">
                <h3 class="archive-entry-title">
                    <a href="{{ .Permalink }}">{{ .Title }}</a>
                </h3>
                <span class="archive-entry-date">{{ .Date.Format "January 2, 2006" }}</span>
            </div>
            {{- with .GetTerms "tags" }}
            <div class="archive-entry-tags">
                {{- range . }}
                <span class="archive-entry-tag">{{ .Name }}</span>
                {{- end }}
            </div>
            {{- end }}
        </div>
        {{- end }}
        {{- end }}
    </noscript>
</div>

{{- end }}{{/* end main */}}
